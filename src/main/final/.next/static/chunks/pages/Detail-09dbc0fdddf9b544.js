(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{4782:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Detail",function(){return n(4597)}])},4597:function(e,t,n){"use strict";n.r(t);var a=n(5893),l=n(7294),s=n(1163),o=n(5675),i=n.n(o);n(449);var c=n(7066);t.default=()=>{let e=(0,s.useRouter)(),{seq:t}=e.query,[n,o]=(0,l.useState)(null),[r,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!1),m=(0,l.useRef)(null),[p,g]=(0,l.useState)(!0),[x,j]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"true"===localStorage.getItem("isLoggedIn")&&d(!0)},[]);let[v,b]=(0,l.useState)(!1),[f,D]=(0,l.useState)(!1),[k,S]=(0,l.useState)(""),[C,N]=(0,l.useState)(""),[_,w]=(0,l.useState)(""),[y,T]=(0,l.useState)(""),[E,q]=(0,l.useState)({}),O=(0,l.useRef)(null);(0,l.useEffect)(()=>(x?document.addEventListener("click",L):document.removeEventListener("click",L),()=>{document.removeEventListener("click",L)}),[x]);let L=e=>{O.current&&!O.current.contains(e.target)&&j(!1)};(0,l.useEffect)(()=>{let e=localStorage.getItem("grantType"),t=localStorage.getItem("accessToken"),n=localStorage.getItem("username");n&&e&&t&&(N(e),w(t),T(n)),F(),B()},[t]);let F=()=>{c.Z.post("http://localhost:9000/volunteer/getUpdateBoard",t).then(e=>{o({title:e.data.boardDTO.title,content:e.data.boardDTO.content,seq:e.data.boardDTO.seq,email:e.data.boardDTO.email,name:e.data.boardDTO.name,id:e.data.boardDTO.id,board_time:e.data.boardDTO.board_time,board_lastTime:e.data.boardDTO.board_lastTime,volun_address:e.data.boardDTO.volun_address,volun_institution:e.data.boardDTO.volun_institution,volun_date:e.data.boardDTO.volun_date})}).catch(e=>console.log(e))},[I,M]=(0,l.useState)([]),B=()=>{console.log("코멘트 줘"),c.Z.post("http://localhost:9000/comment/getCommentList",t).then(e=>{console.log(e.data),M(e.data.content)}).catch(e=>console.log(e))};(0,l.useEffect)(()=>{P()},[n]);let P=()=>{if(!n||!n.seq)return;let e=document.getElementById("content-".concat(n.seq));if(e){let t=new DOMParser().parseFromString(n.content,"text/html");t.querySelectorAll("oembed").forEach(e=>{let t=e.getAttribute("url");if(t&&t.includes("youtube.com")){let n=new URL(t).searchParams.get("v"),a=document.createElement("iframe");a.src="https://www.youtube.com/embed/".concat(n),a.title="video",a.allowFullscreen=!0,a.width="100%",a.height="auto",a.style.maxWidth="300px",a.style.height="180px",e.replaceWith(a)}});let a=t.getElementsByTagName("img");for(let e=0;e<a.length;e++){let t=a[e],n=t.width,l=t.height;if(n>300){let e=300/n;t.width=Math.round(n*e),t.height=Math.round(l*e)}}e.innerHTML=t.body.innerHTML,console.log("content를 html에서변환")}},A=t=>{h(!1),e.push(t)};if(!n)return(0,a.jsx)("div",{children:"봉사활동을 찾을 수 없습니다."});let R=t=>{if(n.id===y)return alert("자신이 작성한 글에는 평가를 남길 수 없습니다."),null;let a=localStorage.getItem("grantType"),l=localStorage.getItem("accessToken"),s={};null!==a&&null!==l&&(s={Authorization:"".concat(a).concat(l)}),c.Z.post("http://localhost:9000/comment/writeComment",{boardSeq:t,member_id:y,content:k,isGoodVolun:p},{headers:s}).then(n=>{console.log(n.data),e.push("/Detail?seq="+t)}).catch(e=>console.log(e)),B()},V=t=>{c.Z.post("http://localhost:9000/volunteer/deleteBoard",null,{headers:{Authorization:C+_},params:{seq:t,member_id:y}}),D(!0),setTimeout(()=>{D(!1),e.push("/FindVolunteer")},2e3)},Z=t=>{e.push("/UDVolun?seq=".concat(t))},z=e=>{let t={};null!==C&&null!==_&&(t={Authorization:"".concat(C).concat(_)}),console.log("삭제: "+e),c.Z.post("http://localhost:9000/comment/deleteComment",e,{headers:t}).then(e=>console.log(e.data)).catch(e=>console.log(e)),alert("댓글 삭제 완료"),B()};return(0,a.jsxs)("div",{className:"main-screen ".concat(u?"sidebar-open":""),onClick:u?e=>{m.current&&!m.current.contains(e.target)&&h(!1)}:void 0,children:[(0,a.jsxs)("div",{className:"sidebar",children:[(0,a.jsx)("div",{className:"sidebar-link",onClick:()=>A("/Search"),children:(0,a.jsx)("span",{children:"\uD83D\uDD0D Search"})}),!r&&(0,a.jsx)("div",{className:"sidebar-link",onClick:()=>A("/Login"),children:(0,a.jsx)("span",{children:"\uD83D\uDD12 Login"})}),r&&(0,a.jsx)("div",{className:"sidebar-link",onClick:()=>A("/Mypage"),children:(0,a.jsx)("span",{children:"\uD83D\uDC64 My Page"})}),(0,a.jsx)("div",{className:"sidebar-link",onClick:()=>A("/Chat"),children:(0,a.jsx)("span",{children:"\uD83E\uDD16 ChatBot"})})]}),(0,a.jsxs)("header",{className:"header",children:[(0,a.jsx)("div",{onClick:()=>{e.push("/Search")},style:{cursor:"pointer"},children:(0,a.jsx)(i(),{src:"/images/image-23.png",alt:"search",width:40,height:40})}),(0,a.jsx)("div",{className:"center-image-container",onClick:()=>{e.push("/First")},style:{cursor:"pointer"},children:(0,a.jsx)(i(),{className:"center-image",src:"/images/first.png",alt:"투게더!",width:120,height:45})}),(0,a.jsxs)("div",{className:"alert-container",onClick:()=>{j(!x)},style:{cursor:"pointer",position:"relative"},ref:O,children:[(0,a.jsx)(i(),{src:"/images/alert.png",alt:"alert",className:"alert-icon",width:50,height:50}),x&&(0,a.jsx)("div",{className:"alert-dropdown",style:{position:"absolute",top:"60px",right:"0",backgroundColor:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",borderRadius:"4px"},children:(0,a.jsxs)("ul",{style:{listStyle:"none",padding:"10px",margin:"0"},children:[(0,a.jsx)("li",{style:{padding:"8px 0",borderBottom:"1px solid #ddd"},children:"알림 1"}),(0,a.jsx)("li",{style:{padding:"8px 0",borderBottom:"1px solid #ddd"},children:"알림 2"}),(0,a.jsx)("li",{style:{padding:"8px 0"},children:"알림 3"})]})})]})]}),(0,a.jsxs)("div",{className:"content",children:[(0,a.jsx)("h1",{children:n.title}),(0,a.jsx)("p",{id:"content-".concat(n.seq)}),(0,a.jsx)("p",{children:n.volun_date}),(0,a.jsx)("p",{children:n.volun_address}),(0,a.jsxs)("p",{children:["작성자 메일 주소: ",n.email]}),n.id===y&&(0,a.jsx)("button",{onClick:()=>V(n.seq),children:"글 삭제"}),n.id===y&&(0,a.jsx)("button",{onClick:()=>Z(n.seq),children:"글 수정"}),(0,a.jsxs)("div",{className:"comments",children:[(0,a.jsx)("h3",{children:"댓글:"}),(0,a.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),placeholder:"댓글을 입력하세요"}),(0,a.jsx)("input",{type:"radio",name:"isGood",value:"true",defaultChecked:!0,onClick:()=>g(!0)}),(0,a.jsx)(i(),{src:"/images/smile.png",alt:"true",width:20,height:20}),(0,a.jsx)("input",{type:"radio",name:"isGood",value:"false",onClick:()=>g(!1)}),(0,a.jsx)(i(),{src:"/images/sad.png",alt:"false",width:20,height:20}),(0,a.jsx)("button",{onClick:()=>R(n.seq),children:"댓글 달기"}),I.map((e,t)=>{let n=new Date(e.comment_time),l="".concat(n.getFullYear(),"-").concat((n.getMonth()+1).toString().padStart(2,"0"),"-").concat(n.getDate().toString().padStart(2,"0"));return(0,a.jsxs)("p",{className:"commentContainer",children:[(0,a.jsx)("div",{className:"comment_createTime",children:l}),(0,a.jsx)("div",{className:"comment_content",children:e.content}),e.member_id===y&&(0,a.jsx)("button",{onClick:()=>z(e.commentSeq),children:"글 삭제"})]},e.commentSeq)})]}),n.auth&&(0,a.jsx)("p",{children:n.auth}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"participate-button",onClick:()=>{b(!0),setTimeout(()=>{b(!1),window.location.href="/FindVolunteer"},2e3)},children:"참여하기"}),v&&(0,a.jsxs)("div",{className:"modal",children:[n.email,"로 신청서 내주시면 됩니다. 신청서를 낼 때는 신청자 이름, 연락처 등을 함께 제출해주시면 좋습니다."]})]}),f&&(0,a.jsx)("div",{className:"modal",children:(0,a.jsx)("div",{className:"modal-content",children:"삭제를 완료했습니다."})})]}),(0,a.jsxs)("footer",{className:"footer",children:[(0,a.jsx)("div",{className:"footer-icon",onClick:()=>{h(!u),h(!u)},children:"="}),(0,a.jsx)("div",{className:"footer-icon",onClick:()=>{e.push("/FindVolunteer")},children:"\uD83C\uDFE0"}),(0,a.jsx)("div",{className:"footer-icon",onClick:()=>{e.push("/Profile")},children:"\uD83D\uDC64"})]})]})}},449:function(){}},function(e){e.O(0,[873,702,888,774,179],function(){return e(e.s=4782)}),_N_E=e.O()}]);