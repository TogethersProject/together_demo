(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{7024:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Calendar",function(){return a(74)}])},74:function(e,t,a){"use strict";a.r(t);var n=a(5893),l=a(7294),o=a(5675),s=a.n(o),r=a(1163),c=a(3907),i=a(1132),d=a(9897);a(3577);var h=a(7066);t.default=()=>{let e=(0,r.useRouter)(),[t,a]=(0,l.useState)(!1),[o,u]=(0,l.useState)([{id:"1",title:"Event 1",start:"2023-06-20"},{id:"2",title:"Event 2",start:"2023-06-21"}]),[g,m]=(0,l.useState)({start:"",end:""}),[k,p]=(0,l.useState)({title:"",content:"",id:"",calendar_memberId:"",allDay:!1,backgroundColor:""}),[C,v]=(0,l.useState)(""),[x,b]=(0,l.useState)(""),[j,y]=(0,l.useState)(""),[N,w]=(0,l.useState)(!1),[S,D]=(0,l.useState)(!1),[f,_]=(0,l.useState)(!1),E=()=>{console.log(g.start+"\n"+g.end+"\n"+k.calendar_memberId),console.log("getCalendar - accessToken: "+C+x);let e=g.start,t=g.end;h.Z.post("http://localhost:9000/calendar/getCalendarList",{startDate:e,endDate:t,memberId:j},{headers:{Authorization:C+x}}).then(e=>{u(t=>[...e.data])}).catch(e=>console.log("캘린더 못가져옴\n"+e))};(0,l.useEffect)(()=>{let t=localStorage.getItem("grantType"),a=localStorage.getItem("accessToken"),n=localStorage.getItem("username");t&&a&&n?(v(t),b(a),y(n)):e.push("/Login")},[]),(0,l.useEffect)(()=>{g.start&&g.end&&E()},[g]);let T=t=>{a(!1),e.push(t)},I=e=>{console.log("드래그"),console.log(e),L(e),w(!0)},L=e=>{let t=e.event._def.extendedProps.calendar_id,a=new Date(e.event._instance.range.start),n=new Date(e.event._instance.range.end),l=new Date(a.getTime()-324e5),o=new Date(n.getTime()-324e5);console.log("토큰줄게 일정 하나만 줘:"+C+x),alert(C+x),h.Z.post("http://localhost:9000/calendar/getOneCalendar",t,{headers:{Authorization:C+x}}).then(e=>{console.log(e.data),p({...e.data,id:t,start:new Date(e.data.start),newStart:l,...null!=e.data.end&&{end:new Date(e.data.end)},...null!=e.data.end&&{newEnd:o}})}).catch(e=>console.log(e))},M=e=>{let{name:t,value:a}=e.target;p(e=>({...e,[t]:a,backgroundColor:"backgroundColor"===t?a:e.backgroundColor}))};return(0,n.jsxs)("div",{className:"main-screen ".concat(t?"sidebar-open":""),onClick:t?e=>{let t=document.querySelector(".sidebar");t&&!t.contains(e.target)&&a(!1)}:void 0,children:[(0,n.jsxs)("div",{className:"sidebar",children:[(0,n.jsx)("div",{className:"sidebar-link",onClick:()=>T("/Search"),children:"Search"}),(0,n.jsx)("div",{className:"sidebar-link",onClick:()=>T("/Login"),children:"Login"}),(0,n.jsx)("div",{className:"sidebar-link",onClick:()=>T("/My"),children:"My"}),(0,n.jsx)("div",{className:"sidebar-link",onClick:()=>T("/Chat"),children:"ChatBot"})]}),(0,n.jsxs)("header",{className:"header",children:[(0,n.jsx)(s(),{src:"/images/image-23.png",alt:"search",width:40,height:40}),(0,n.jsx)("div",{className:"center-image-container",onClick:function(){e.push("/First")},style:{cursor:"pointer"},children:(0,n.jsx)(s(),{className:"center-image",src:"/images/first.png",alt:"투게더!",width:120,height:45})}),(0,n.jsx)(s(),{src:"/images/alert.png",alt:"alert",className:"alert-icon",width:50,height:50})]}),(0,n.jsxs)("div",{className:"content",children:[(0,n.jsx)("div",{className:"intro",children:(0,n.jsx)("h1",{children:"봉사 일정을 확인하세요"})}),(0,n.jsx)("div",{className:"calendar-container",children:(0,n.jsx)(c.Z,{plugins:[i.Z,d.ZP],initialView:"dayGridMonth",events:o,dateClick:e=>{p({title:"",content:"",start:e.date,id:"",allDay:!1,calendar_memberId:j,backgroundColor:""}),D(!0)},eventClick:e=>{console.log("드래그"),console.log(e),L(e),w(!0)},select:e=>{p(t=>({title:"",content:"",start:e.start,end:e.end,id:"",allDay:!1,calendar_memberId:j,backgroundColor:""})),D(!0)},selectable:!0,selectMirror:!0,editable:!0,eventDurationEditable:!0,eventResizableFromStart:!0,eventResize:I,eventChange:I,datesSet:e=>{console.log(e.startStr),console.log(e.endStr),m(t=>({...t,start:e.startStr,end:e.endStr}))},locale:"ko",weekends:!0,navLinks:!0,navLinkHint:"클릭시 해당 날짜로 이동합니다.",dayMaxEvents:!0,eventBackgroundColor:"yellowgreen",eventBorderColor:"yellowgreen",height:"auto"})}),(0,n.jsx)("div",{className:"calendar-modal"}),S&&(0,n.jsxs)("div",{className:"calendar-modal",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"modal-header",children:(0,n.jsx)("button",{onClick:()=>w(!1),children:"\xd7모달닫기"})}),(0,n.jsxs)("div",{className:"modal-body",children:["칠드런",(0,n.jsx)("br",{}),(0,n.jsxs)("p",{children:["일정 시작일: ",k.start&&new Date(k.start).toLocaleString(),"시간: ",(0,n.jsx)("input",{type:"time",onChange:e=>{if(k.start){let[t,a]=e.target.value.split(":"),n=new Date(k.start);n.setHours(t),n.setMinutes(a),console.log(n),n&&p({...k,start:n})}},name:"eventStartTime"})]}),(0,n.jsxs)("p",{children:["일정 마감일: ",k.end&&new Date(k.end).toLocaleString()," 시간:",(0,n.jsx)("input",{type:"time",onChange:e=>{if(k.end){let[t,a]=e.target.value.split(":"),n=new Date(k.end);n.setHours(t),n.setMinutes(a),console.log(n),p({...k,end:n})}},name:"eventEndTime"})]}),(0,n.jsx)("input",{type:"checkbox",onChange:e=>{let t=e.target.checked;_(t),p({...k,allDay:t})},checked:f,name:"allDay"}),"allDay 체크여부",(0,n.jsx)("input",{type:"text",onChange:M,name:"title",value:k.title,placeholder:"제목"}),(0,n.jsx)("input",{type:"text",onChange:M,name:"content",value:k.content,placeholder:"내용"}),(0,n.jsx)("input",{type:"radio",onChange:M,name:"backgroundColor",value:"skyblue",checked:"skyblue"===k.backgroundColor}),"파랑",(0,n.jsx)("input",{type:"radio",onChange:M,name:"backgroundColor",value:"orange",checked:"orange"===k.backgroundColor}),"오렌지",(0,n.jsx)("input",{type:"text",onChange:M,name:"backgroundColor",value:k.backgroundColor,placeholder:"색상 알아서 잘 넣어보도록. 나중에는 체크박스나 다른 기능 필요"})]}),(0,n.jsx)("div",{className:"modal-footer",children:(0,n.jsx)("button",{type:"button",onClick:()=>{console.log("제출 전, 정보 확인: ",k),console.log("accessToken: "+C+x),h.Z.post("http://localhost:9000/calendar/writeCalendar",k,{headers:{Authorization:C+x}}).then(e=>{console.log("제출성공"+e),E(),p(e=>({title:"",content:"",id:"",calendar_memberId:"",allDay:!1,backgroundColor:""}))}).catch(e=>console.log("제출오류"+e))},children:"제출하기"})})]})]}),(0,n.jsxs)("footer",{className:"footer",children:[(0,n.jsx)("div",{className:"footer-icon",onClick:()=>{a(!t)},children:"="}),(0,n.jsx)("div",{className:"footer-icon",onClick:()=>{e.push("/First")},children:"\uD83C\uDFE0"}),(0,n.jsx)("div",{className:"footer-icon",onClick:()=>{e.push("/Mypage")},children:"\uD83D\uDC64"})]})]})}},3577:function(){}},function(e){e.O(0,[69,873,702,168,888,774,179],function(){return e(e.s=7024)}),_N_E=e.O()}]);